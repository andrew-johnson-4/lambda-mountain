
import lib2/core/bedrock.lsts;

type alias AContext = List<(CString,AST)>;

let substitute(ctx: AContext, tt: Type): Type = tt;

type AST zero ASTEOF implies MustRetain, MustRelease
         = AType { tt: Type };

let apply(ctx: AContext, term: AST): AST = (
   AType(substitute(ctx,tt));
);

let .retain(t: AST): AST = (
   if t.discriminator-case-tag==(t as Tag::AType).discriminator-case-tag {
      mark-as-released((t as Tag::AType).tt.retain);
   };
   t
);

let .release(t: AST): Nil = (
   if t.discriminator-case-tag==(t as Tag::AType).discriminator-case-tag {
      (t as Tag::AType).tt.release;
   };
   mark-as-released(t);
);

type Type zero TAny implies MustRetain, MustRelease
        = TAny;

let .release(t: Type): Nil = (
   mark-as-released(t);
);

let .retain(t: Type): Type = (
   t
);
