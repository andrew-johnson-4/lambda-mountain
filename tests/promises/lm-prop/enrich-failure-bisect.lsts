
import LM23COMMON/unit-type-core.lsts;

let enrich-quick-prop(): Nil = (
   let quick-prop = {} : Hashtable<(CString,U64),List<(Type,Type)>>;
   let val = [] : List<(Type,Type)>;
   val = cons( (t0(c"B.2"),t0(c"B.3")), val );
   quick-prop = quick-prop.bind( (c"B.1",0_u64), val );
   let base = t0(c"B.1") && t0(c"B.2");
   let pre = base;
   let result = mk-vector(type(Type));
   for vector c in mk-vector(type(Type)).push(t0(c"B.1")).push(t0(c"B.2")) {
      for list row in quick-prop.lookup( c.ground-tag-and-arity, ([] : List<(Type,Type)>) ) {
         c = c && row.second;
      };
      match c {
         TAnd{rconjugate=conjugate} => for vector rc in rconjugate { result = result.push(rc) };
         TAny{} => ();
         rc => ( result = result.push(rc); () );
      }
   };
);

enrich-quick-prop();
