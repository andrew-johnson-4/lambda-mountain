
import lib/std/minimal.lsts;

# TODO: add test for empty string
# empty string shouldn't need allocation
# but there is a phi bug preventing that implementation atm

# new allocations:
# 1 mk-vector creates buffer then turns it into a string
# 1 string literal "a"
assert( mk-vector(type(U8), 1).push(97).buffer-into-string == "a" );
assert( safe-alloc-block-count == 0 );
assert( safe-alloc-block-count-monotonic == 2 );
safe-alloc-block-count-monotonic = 0;
