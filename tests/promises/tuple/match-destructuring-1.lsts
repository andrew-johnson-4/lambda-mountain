
import lib2/core/bedrock.lsts;

type T = { tag:CString };

let .ground-tag-and-arity(tt: T): (CString,U64) = (
   let t1 = tt;
   (scope($"if"
      (
         let c1 = false;
         $"if"
            (
               let t2 = t1.tag;
               t2 == c"Array"
            )
            (c1 = true)
            ()
         ;
         c1
      )
      ((c"Array", 2_u64))
      (scope($"if"
         (
            let c2 = false;
            ($"if"
              (let tag = t1.tag; branchtrue())
              (c2 = true)
              ()
            );
            c2
         )
         ((tag, 1_u64))
         (fail(c"Pattern Match Failure"))
      ))
   ))
);


